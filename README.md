# 卫星链路预算计算器使用手册  
（支持上行 / 下行双链路计算）  

## 一、软件概述  
本工具用于卫星通信链路预算分析，支持 **上行链路（地球站→卫星）和下行链路（卫星→地球站）** 独立计算。通过输入关键参数，自动生成链路损耗、功率谱密度、载噪比（C/N）、C/(N+I)等核心指标，并支持 Excel 报告导出。  

## 二、核心功能升级  
| 功能模块       | 新增 / 优化内容                               |  
|----------------|-----------------------------------------------|  
| 链路方向管理   | 新增「上行 / 下行」切换按钮，动态适配参数输入项       |  
| 参数动态切换   | 按链路方向显示专属参数（如上行显示 “终端 EIRP”，下行显示 “卫星 EIRP”） |  
| 双链路对比     | 支持同时计算上下行数据，生成对比分析报告               |  
| 公式化输入     | 保留三角函数、对数等表达式支持（如 sin(60)、10*log10(5)）    |  
| 主题与报告     | 深色 / 浅色模式切换，Excel 报告含链路方向标签             |  

## 三、界面操作指南  

### 3.1 主界面布局  
- **顶部工具栏**：  
  - 🟢 上行链路/🔵 下行链路：切换计算方向，参数区自动刷新  
  - 📊 计算：触发当前链路计算  
  - 🗑️ 重置：清空当前链路参数  
  - 🌙 主题切换：深色 / 浅色模式  
  - 📄 输出报告：生成含上下行数据的 Excel 文件  
- **参数输入区**：  
  - **共用参数**：频率、带宽、卫星高度、卫星扫描角（上下行共用）  
  - **专属参数**：  
    - 上行：终端 EIRP、卫星天线增益、卫星噪声系数、卫星天线噪声温度  
    - 下行：卫星 EIRP、终端噪声系数、终端天线噪声温度、终端天线增益  
  - **损耗参数**：大气损耗、闪烁损耗、极化损耗、波束边缘损耗、扫描损耗、降雨率（部分项需勾选启用）  
  - **链路余量**：链路余量（dB）  
  - **干扰**：干扰信号功率谱密度（dBm/MHz）  
- **结果显示区**：  
  - 分栏显示当前链路的链路状态（如终端仰角、星地距离、路径损耗、雨衰等）和链路性能（如接收信号功率谱密度、噪声功率谱密度、C/N、C/(N+I)、G/T值等）  
  - 支持切换「详细模式」查看中间计算步骤  

## 四、参数说明（上行 / 下行区分）  

### 4.1 共用参数（上下行一致）  
| 参数名称         | 单位   | 说明                          |  
|------------------|--------|-------------------------------|  
| 频率 (GHz)       | GHz    | 通信载波频率（上下行可不同）          |  
| 带宽 (MHz)       | MHz    | 信号占用带宽                     |  
| 卫星高度 (km)    | km     | 卫星轨道高度                     |  
| 卫星扫描角 (度)  | °      | 卫星扫描角度                     |  

### 4.2 上行链路专属参数  
| 参数名称         | 单位   | 说明                          |  
|------------------|--------|-------------------------------|  
| 终端 EIRP (dBW)  | dBW    | 地球站等效全向辐射功率              |  
| 卫星天线增益 (dBi)| dBi    | 卫星天线增益                     |  
| 卫星噪声系数 (dB)| dB     | 卫星接收系统噪声系数                |  
| 卫星天线噪声温度 (K)| K     | 卫星天线噪声温度                   |  

### 4.3 下行链路专属参数  
| 参数名称         | 单位   | 说明                          |  
|------------------|--------|-------------------------------|  
| 卫星 EIRP (dBW)  | dBW    | 卫星等效全向辐射功率                |  
| 终端噪声系数 (dB)| dB     | 终端接收系统噪声系数                |  
| 终端天线噪声温度 (K)| K     | 终端天线噪声温度                   |  
| 终端天线增益 (dBi)| dBi    | 终端天线增益                     |  

### 4.4 损耗参数  
| 参数名称         | 单位   | 说明                          |  
|------------------|--------|-------------------------------|  
| 大气损耗 (dB)    | dB     | 大气对信号的损耗                  |  
| 闪烁损耗 (dB)    | dB     | 信号闪烁产生的损耗                  |  
| 极化损耗 (dB)    | dB     | 极化不匹配产生的损耗                |  
| 波束边缘损耗 (dB) | dB     | 波束边缘信号强度减弱产生的损耗          |  
| 扫描损耗 (dB)    | dB     | 卫星扫描产生的损耗                  |  
| 降雨率 (mm/h)    | mm/h   | 降雨强度，用于计算雨衰                |  

### 4.5 链路余量  
| 参数名称         | 单位   | 说明                          |  
|------------------|--------|-------------------------------|  
| 链路余量 (dB)    | dB     | 链路设计时预留的余量                |  

### 4.6 干扰  
| 参数名称         | 单位   | 说明                          |  
|------------------|--------|-------------------------------|  
| 干扰信号功率谱密度 (dBm/MHz)| dBm/MHz | 干扰信号的功率谱密度              |  

## 五、计算公式  

### 5.1 通用计算公式  
- **路径损耗 \(L_p\)**：由 `LinkCalculator` 类中的 `calculate_path_loss` 方法计算，与频率和星地距离有关。  
- **雨衰 \(A_r\)**：由 `LinkCalculator` 类中的 `calculate_rain_fade` 方法计算，与频率、终端仰角和降雨率有关。  
- **噪声功率谱密度 \(N_0\)**：由 `LinkCalculator` 类中的 `calculate_noise_psd` 方法计算，与接收机噪声系数和接收天线噪声温度有关。  
- **C/N (dB)**：\(\text{C/N (dB)} = \text{接收信号功率谱密度} - \text{噪声功率谱密度}\)  
- **G/T值 (dB/K)**：\(\text{G/T值 (dB/K)} = \text{接收天线增益} - 10\log_{10}(\text{系统噪声温度})\)  
- **C/(N+I)**：考虑干扰信号时，将接收信号功率、噪声功率和干扰信号功率转换为线性值进行计算，再转换回dB值。无干扰时，C/(N+I) 等于 C/N。  

### 5.2 上行链路专用公式  
- **总损耗（上行）** \( = \text{大气损耗} + \text{电离层损耗} + \text{极化损耗} + \text{雨衰（若启用）}\)  
- **地球站发射功率谱密度** \( = \text{终端 EIRP} + \text{终端天线增益} - L_p - \text{总损耗（上行）}\)  

### 5.3 下行链路专用公式  
- **地球站接收功率谱密度** \( = \text{卫星 EIRP} + \text{卫星天线增益} - L_p - \text{总损耗（下行）}\)  
- **总损耗（下行）** \( = \text{大气损耗} + \text{对流层损耗} + \text{极化损耗} + \text{雨衰（若启用）}\)  

## 六、操作流程示例  

### 6.1 单链路计算（以下行链路为例）  
1. **切换方向**：点击顶部「下行链路」按钮  
2. **输入参数**：  
   - 频率：20 GHz，卫星高度：36000 km（同步轨道）  
   - 卫星 EIRP：58 dBW，卫星天线增益：45 dBi  
   - 卫星扫描角：0°，降雨率：50 mm/h（勾选启用）  
   - 大气损耗：0.1 dB，闪烁损耗：0.3 dB，极化损耗：3 dB，波束边缘损耗：1 dB，扫描损耗：4 dB，链路余量：3 dB，干扰信号功率谱密度：-inf dBm/MHz  
3. **点击计算**：右侧显示「接收功率谱密度」「C/N 比」「C/(N+I)」「终端G/T值」等结果  
4. **导出报告**：点击「输出报告」生成含时间戳的 Excel 文件  

### 6.2 双链路对比计算  
1. **计算上行**：切换至「上行链路」，输入地球站参数（如终端 EIRP、终端天线增益、终端噪声系数等）并计算  
2. **计算下行**：切换至「下行链路」，输入卫星参数（如卫星 EIRP、卫星天线增益、卫星噪声系数等）并计算  
3. **查看对比**：报告自动生成上下行数据对比表（如损耗分布、功率差值）  

## 七、注意事项  
- **链路方向必选**：启动后默认「下行链路」，未选择方向时无法计算  
- **频率独立性**：上下行可设置不同频率（如转发器变频场景）  
- **损耗项勾选**：雨衰、电离层损耗等需手动勾选复选框才生效  
- **公式输入规范**：  
  - 支持 sin()、cos()、tan()、log()、^（幂运算）等，如 50-20*log10(1000)  
  - 角度默认单位为「度」，无需转换（内部自动处理）  
- **报告内容**：Excel 文件包含输入参数、中间计算步骤、最终指标及链路方向标签  

## 八、常见问题  
- **Q**：上下行链路的噪声系数如何区分？  
  - **A**：上行链路使用「终端噪声系数」（地球站接收噪声），下行链路使用「卫星噪声系数」（卫星接收噪声），需按方向输入对应参数。  
- **Q**：计算结果显示 “NaN” 怎么办？  
  - **A**：检查是否遗漏必填参数（如频率、EIRP），或公式输入有误（如括号不匹配）。  
- **Q**：如何优化计算速度？  
  - **A**：关闭未使用的损耗项（如不勾选雨衰），或减少公式复杂度（避免嵌套多层函数）。  

**版本说明**：当前手册适用于 v3.0+ 版本，新增功能请以软件实际界面为准。如需技术支持，请联系开发者或提交 Issue。  